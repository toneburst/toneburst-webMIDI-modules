function TBMWMIDIio(){this.uicontainer=null,this.containerclass="midiui",this.idprefix="tbwm-io",this.outputselectid=this.idprefix+"-outputdevice",this.channelselectid=this.idprefix+"-channel",this.testoutputbutton=this.idprefix+"-testoutput",this.havemidi=!1,this.havemidiin=!1,this.havemidiout=!1,this.havecontainer=!1,this.midiaccess={},this.outputs={},this.inputs={},this.midiout={},this.midiin={},this.midichannel=1}MicroEvent.mixin(TBMWMIDIio),TBMWMIDIio.prototype.errordomelement=function(){var t="Error: Container element not found. You need to specify ID of an existing element (with or without leading '#') when initialising this instance or calling this method";return console.log(t),t},TBMWMIDIio.prototype.errornomidi=function(t){this.havemidi=!1;var i=t;console.log(i)},TBMWMIDIio.prototype.errornooutputdevice=function(){this.havemidiout=!1;var t="Error: No MIDI output device is accessible.";console.log(t)},TBMWMIDIio.prototype.errornoinputdevice=function(){this.havemidi=!1;var t="Error: No MIDI input device is accessible.";console.log(t)},TBMWMIDIio.prototype.channelmessage=function(t,i){var e={noteoff:8,noteon:9,controlchange:11,channelmode:11,programchange:12,channelaftertouch:13,pitchbend:14};return(e[t]<<4)+(i-1)},TBMWMIDIio.prototype.createlabel=function(t,i){var e=document.createElement("label");return e.setAttribute("for",t),e.innerHTML=i,e},TBMWMIDIio.prototype.init=function(t){function i(t){o.havemidi=!0,o.midiaccess=t,o.outputs=o.midiaccess.outputs,o.outputs.size>0?(o.midiout=o.outputs.values().next().value,o.midiout.open(),o.havemidiout=!0):(o.errornooutputdevice(),o.havemidiout=!1),console.log("MIDI system success!"),o.trigger("midistatus","success")}function e(t){o.havemidi=!1,o.havemidiin=!1,o.havemidiout=!1,console.log("Uh-oh! Something went wrong! Error code: "+t.code),o.trigger("midistatus","fail")}if(!t)return this.errordomelement();if(this.uicontainer=document.getElementById(t.replace("#","")),!this.uicontainer)return this.errordomelement();this.havecontainer=!0,this.uicontainer.classList.add(this.containerclass);var o=this;navigator.requestMIDIAccess().then(i,e)},TBMWMIDIio.prototype.setoutputdevice=function(t){return this.havemidiout?(this.midiout.close(),this.midiout=this.outputs.get(t),this.midiout.open(),void 0):void this.errornooutputdevice()},TBMWMIDIio.prototype.addoutputselect=function(){if(this.havemidi&&this.havemidiout){var t=this.createlabel(this.outputselectid,"Select MIDI Output Device"),i=document.createElement("select");i.setAttribute("id",this.outputselectid),this.outputs.forEach(function(t){var e=document.createElement("option");e.text=t.name,e.value=t.id,i.add(e)}),this.uicontainer.appendChild(t),this.uicontainer.appendChild(i);var e=this;i.addEventListener("change",function(){e.setoutputdevice(this.value)})}else this.errornooutputdevice()},TBMWMIDIio.prototype.setoutmidichannel=function(t){this.midichannel=parseInt(t)},TBMWMIDIio.prototype.addoutchannelselect=function(){if(!this.havemidi||!this.havemidiout)return void this.errornooutputdevice();var t=this.createlabel(this.channelselectid,"Select MIDI Channel"),i=document.createElement("select");i.setAttribute("id",this.channelselectid);for(var e=1;17>e;e++){var o=document.createElement("option");o.text=e,o.value=e,i.add(o)}this.uicontainer.appendChild(t),this.uicontainer.appendChild(i);var n=this;i.addEventListener("change",function(){n.setoutmidichannel(parseInt(this.value))})},TBMWMIDIio.prototype.addtestbutton=function(){if(!this.havemidi||!this.havemidiout)return void this.errornooutputdevice();var t=document.createElement("button");t.setAttribute("id",this.testoutputbutton),t.innerHTML="Test MIDI Out",this.uicontainer.appendChild(t);var i=this;t.addEventListener("mousedown",function(){i.noteon(null,64,127)},!1),t.addEventListener("mouseup",function(){i.noteoff(null,64,127)},!1)},TBMWMIDIio.prototype.noteon=function(t,i,e){if(!this.havemidi||!this.havemidiout)return void this.errornooutputdevice();var o=t?t:this.midichannel,n=this.channelmessage("noteon",o);this.midiout.send([n,i,e])},TBMWMIDIio.prototype.noteoff=function(t,i,e){if(!this.havemidi||!this.havemidiout)return void this.errornooutputdevice();var o=t?t:this.midichannel,n=this.channelmessage("noteoff",o);this.midiout.send([n,i,e])},TBMWMIDIio.prototype.clocktick=function(){self.midiout.send([248])};